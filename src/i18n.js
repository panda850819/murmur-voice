const I18N = {
  en: {
    "header.title": "Preferences",
    "group.input": "Input",
    "group.transcription": "Transcription",
    "group.ai": "AI Processing",
    "group.recording": "Recording",
    "group.appearance": "Appearance",
    "group.system": "System",
    "row.ptt": "Push-to-Talk",
    "row.language": "Language",
    "row.engine": "Engine",
    "row.model": "Model",
    "row.dict": "Dictionary",
    "row.llm": "LLM Post-Processing",
    "row.provider": "Provider",
    "row.apiKey": "API Key",
    "row.url": "URL",
    "row.endpoint": "Endpoint",
    "row.appAware": "App-Aware Style",
    "row.mode": "Mode",
    "row.opacity": "Opacity",
    "row.autoStart": "Launch at Login",
    "row.updates": "Updates",
    "row.changelog": "What's New",
    "row.uiLocale": "UI Language",
    "btn.checkUpdate": "Check for Updates",
    "btn.changelog": "Changelog",
    "btn.cancel": "Cancel",
    "btn.save": "Save",
    "btn.holdToTalk": "Hold to Talk",
    "btn.pressToToggle": "Press to Toggle",
    "hint.groqKey": "API Key is in AI Processing below",
    "hint.llm": "Auto-clean filler words, add punctuation, fix grammar after transcription",
    "hint.appAware": "Auto-adjust tone based on active app (e.g. terminal \u2192 technical style)",
    "hint.ollama": "Runs locally, fully offline. Requires Ollama installed.",
    "dict.placeholder": "Type a term and press Enter",
    "vision.tagline": "Your voice, unheard by others.",
    "vision.roadmap": "Roadmap",
    "onboard.welcome": "Welcome to Murmur Voice",
    "onboard.welcomeDesc": "Privacy-first voice-to-text for macOS. Your audio is processed locally using Whisper \u2014 nothing leaves your machine.",
    "onboard.localProcessing": "100% local processing",
    "onboard.pushToTalk": "Push-to-talk with modifier keys",
    "onboard.autoPaste": "Auto-paste transcription to any app",
    "onboard.getStarted": "Get Started",
    "onboard.permissions": "Permissions",
    "onboard.permissionsDesc": "Murmur needs two system permissions to work properly.",
    "onboard.microphone": "Microphone",
    "onboard.micHint": "System Settings \u203a Privacy & Security \u203a Microphone",
    "onboard.accessibility": "Accessibility",
    "onboard.accHint": "System Settings \u203a Privacy & Security \u203a Accessibility",
    "onboard.permissionsNote": "macOS will prompt you automatically. If it doesn\u2019t, open System Settings manually.",
    "onboard.next": "Next",
    "onboard.downloadModel": "Download Model",
    "onboard.downloadDesc": "Whisper large-v3-turbo model for accurate local transcription.",
    "onboard.downloadBtn": "Download (~1.5 GB)",
    "onboard.setHotkey": "Set Your Hotkey",
    "onboard.hotkeyDesc": "Choose a modifier key for push-to-talk. Hold it to record, release to transcribe.",
    "onboard.done": "Done",
    "onboard.back": "Back",
    "onboard.chooseEngine": "Choose Engine",
    "onboard.engineDesc": "How would you like to transcribe your voice?",
    "onboard.engineLocal": "Local (Whisper)",
    "onboard.engineLocalDesc": "GPU-accelerated, 100% offline",
    "onboard.engineGroq": "Cloud (Groq)",
    "onboard.engineGroqDesc": "Fast, no download needed",
    "onboard.apiKeyPlaceholder": "Groq API Key (gsk_...)",
    "onboard.downloading": "Downloading...",
    "onboard.retryDownload": "Retry Download",
    // Settings dynamic
    "ptt.pressKey": "Press a key...",
    "ptt.holdModifier": "Hold modifier key...",
    "ptt.nowPressKey": "Now press a key...",
    "dict.nTerms": "{n} terms",
    "dict.removedTerm": "Removed \"{term}\"",
    "status.saved": "Saved",
    "status.loadFailed": "Failed to load settings",
    "status.saveFailed": "Failed: {err}",
    "update.checking": "Checking...",
    "update.upToDate": "Up to date (v{version})",
    "update.available": "v{version} available",
    "update.failed": "Check failed",
    // State (shared by main + preview)
    "state.init": "Initializing...",
    "state.ready": "Ready",
    "state.starting": "Starting...",
    "state.listening": "Listening...",
    "state.stopping": "Stopping...",
    "state.transcribing": "Transcribing...",
    "state.processing": "Processing...",
    "state.done": "Done",
    "state.error": "Error",
    "state.cancelled": "Cancelled",
    "state.downloadingModel": "Downloading model... {pct}%",
    "state.downloadFailed": "Download failed",
    "state.accessibilityError": "Accessibility required",
    "state.accessibilityHint": "Grant permission in System Settings > Privacy & Security > Accessibility. It will auto-connect.",
    // Preview
    "preview.noSpeech": "No speech detected",
    "preview.copy": "Copy",
    "preview.copied": "Copied!",
    "preview.nChars": "{n} chars",
    "preview.dictPrompt": "Add \"{word}\" to dictionary?",
    "preview.dictAdded": "Added!",
    "preview.add": "Add",
    "preview.addAll": "Add All",
    "preview.dismiss": "Dismiss",
  },
  "zh-TW": {
    "header.title": "偏好設定",
    "group.input": "輸入",
    "group.transcription": "語音轉錄",
    "group.ai": "AI 處理",
    "group.recording": "錄音",
    "group.appearance": "外觀",
    "group.system": "系統",
    "row.ptt": "按鍵說話",
    "row.language": "語言",
    "row.engine": "引擎",
    "row.model": "模型",
    "row.dict": "自訂辭典",
    "row.llm": "LLM 後處理",
    "row.provider": "供應商",
    "row.apiKey": "API Key",
    "row.url": "URL",
    "row.endpoint": "端點",
    "row.appAware": "應用感知風格",
    "row.mode": "模式",
    "row.opacity": "透明度",
    "row.autoStart": "登入時啟動",
    "row.updates": "更新",
    "row.changelog": "新功能",
    "row.uiLocale": "介面語言",
    "btn.checkUpdate": "檢查更新",
    "btn.changelog": "更新日誌",
    "btn.cancel": "取消",
    "btn.save": "儲存",
    "btn.holdToTalk": "長按錄音",
    "btn.pressToToggle": "點按錄音",
    "hint.groqKey": "API Key 在下方 AI 處理區",
    "hint.llm": "語音轉文字後，AI 自動去贅詞、加標點、修文法",
    "hint.appAware": "根據目前 app 自動調整語氣，如終端機 \u2192 技術風格",
    "hint.ollama": "本地執行，完全離線，需先安裝 Ollama",
    "dict.placeholder": "輸入詞彙後按 Enter",
    "vision.tagline": "你的聲音，不被他人聽見。",
    "vision.roadmap": "產品路線圖",
    "onboard.welcome": "歡迎使用 Murmur Voice",
    "onboard.welcomeDesc": "隱私優先的語音轉文字工具。音訊透過 Whisper 在本機處理，不會離開你的電腦。",
    "onboard.localProcessing": "100% 本地處理",
    "onboard.pushToTalk": "按鍵說話，支援自訂快捷鍵",
    "onboard.autoPaste": "轉錄結果自動貼上到任何 app",
    "onboard.getStarted": "開始使用",
    "onboard.permissions": "權限設定",
    "onboard.permissionsDesc": "Murmur 需要兩項系統權限才能正常運作。",
    "onboard.microphone": "麥克風",
    "onboard.micHint": "系統設定 \u203a 隱私權與安全性 \u203a 麥克風",
    "onboard.accessibility": "輔助使用",
    "onboard.accHint": "系統設定 \u203a 隱私權與安全性 \u203a 輔助使用",
    "onboard.permissionsNote": "macOS 會自動提示授權。如果沒有，請手動打開系統設定。",
    "onboard.next": "下一步",
    "onboard.downloadModel": "下載模型",
    "onboard.downloadDesc": "Whisper large-v3-turbo 模型，用於精準的本地語音轉錄。",
    "onboard.downloadBtn": "下載 (~1.5 GB)",
    "onboard.setHotkey": "設定快捷鍵",
    "onboard.hotkeyDesc": "選擇一個修飾鍵作為按鍵說話的快捷鍵。按住錄音，放開即轉錄。",
    "onboard.done": "完成",
    "onboard.back": "返回",
    "onboard.chooseEngine": "選擇引擎",
    "onboard.engineDesc": "你想要如何轉錄語音？",
    "onboard.engineLocal": "本地 (Whisper)",
    "onboard.engineLocalDesc": "GPU 加速，完全離線",
    "onboard.engineGroq": "雲端 (Groq)",
    "onboard.engineGroqDesc": "快速，無需下載模型",
    "onboard.apiKeyPlaceholder": "Groq API Key (gsk_...)",
    "onboard.downloading": "下載中...",
    "onboard.retryDownload": "重試下載",
    "ptt.pressKey": "按下按鍵...",
    "ptt.holdModifier": "按住修飾鍵...",
    "ptt.nowPressKey": "再按一個鍵...",
    "dict.nTerms": "{n} 個詞彙",
    "dict.removedTerm": "已移除「{term}」",
    "status.saved": "已儲存",
    "status.loadFailed": "載入設定失敗",
    "status.saveFailed": "儲存失敗: {err}",
    "update.checking": "檢查中...",
    "update.upToDate": "已是最新版 (v{version})",
    "update.available": "v{version} 可更新",
    "update.failed": "檢查失敗",
    "state.init": "初始化中...",
    "state.ready": "就緒",
    "state.starting": "啟動中...",
    "state.listening": "聆聽中...",
    "state.stopping": "停止中...",
    "state.transcribing": "轉錄中...",
    "state.processing": "處理中...",
    "state.done": "完成",
    "state.error": "錯誤",
    "state.cancelled": "已取消",
    "state.downloadingModel": "下載模型中... {pct}%",
    "state.downloadFailed": "下載失敗",
    "state.accessibilityError": "需要輔助使用權限",
    "state.accessibilityHint": "請至系統設定 > 隱私權與安全性 > 輔助使用 開啟權限，開啟後會自動連線。",
    "preview.noSpeech": "未偵測到語音",
    "preview.copy": "複製",
    "preview.copied": "已複製!",
    "preview.nChars": "{n} 字元",
    "preview.dictPrompt": "加入「{word}」到辭典？",
    "preview.dictAdded": "已加入!",
    "preview.add": "加入",
    "preview.addAll": "全部加入",
    "preview.dismiss": "忽略",
  },
};

let currentLocale = "en";

function t(key) {
  const map = I18N[currentLocale] || I18N.en;
  return map[key] || I18N.en[key] || key;
}

function applyLocale(locale) {
  currentLocale = locale;
  document.querySelectorAll("[data-i18n]").forEach((el) => {
    const key = el.getAttribute("data-i18n");
    const text = t(key);
    if (text && text !== key) {
      if (el.tagName === "INPUT" && el.type !== "checkbox") {
        el.placeholder = text;
      } else {
        el.textContent = text;
      }
    }
  });
}
